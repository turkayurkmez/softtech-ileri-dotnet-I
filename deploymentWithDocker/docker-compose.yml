version: '3.4'

services:  
  ms-sql-server:
    image: mcr.microsoft.com/mssql/server:2022-latest
    environment: 
      ACCEPT_EULA: "Y"
      MSSQL_SA_PASSWORD: "pa55W0rd"
    ports:
     - "1433:1433" 
   

  deploymentwithdocker:
    depends_on:
     - ms-sql-server       
       
    image: ${DOCKER_REGISTRY-}deploymentwithdocker
    build:
      context: .
      dockerfile: deploymentWithDocker/Dockerfile
    environment:
      DBServer: ms-sql-server
      DBPass: pa55W0rd
      ASPNETCORE_Kestrel__Certificates__Default__Password: "trk-0107"
      ASPNETCORE_Kestrel__Certificates__Default__Path: "/https/aspnetapp.pfx"
    volumes:
      - ~/.aspnet/https:/https:ro
   